<!doctype html>
<meta charset="UTF-8"> 
<html>

<head>
    <title>StrainTool</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <!-- add after bootstrap.min.css -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.css">
    <!-- github icon -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>
    <!-- add after bootstrap.min.js -->
    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.js"></script>
    <link rel="icon" https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/DSOtrans.png" type="image/x-icon">
    <style>
        .container {
            margin: 15px auto;
            display: flex;
        }
        #chart_div {
            width: 80%;
        }
        #dparam_div {
            width: 20%;
            vertical-align: middle;
        }
        #chart_div2 {
            width: 80%;
        }
        #inline-code {
            background-color: #eee;
            display: inline;
            padding: 10px;
        }
        #block-code {
            background-color: #eee;
            //border: 1px solid #999;
            //display: block;
            //padding: 20px;
            //white-space: pre-wrap;
            //word-wrap: break-word;
        }
        #block-samp {
            background-color: #eee;
            border: 1px solid #999;
            display: block;
            padding: 20px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .page-header-p {
            font-family: verdana, "Lucida Console", Monospace;
            font-size:3vw;
            max-height: 100%;
        }
        button{
	    margin: 13px;
	    box-shadow: 1px 2px 5px #000000; 
	}
        a.buttons {
	-webkit-font-smoothing: antialiased;
	background: url(https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/arrow-down.png) no-repeat;
	font-weight: normal;
	color: #fff;
/* 	text-shadow: rgba(0, 0, 0, 0.4) 0 -1px 0; */
	padding: 2px 2px 2px 22px;
	height: 30px;
	}

	a.github {
		background: url(https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/octocat-small.png) no-repeat 1px;
	}

	a.buttons:hover {
		color: #fff;
		text-decoration: none;
	}

    </style>
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid" style="maxheight: 15%; background-color: #99ccff;"> <!--#e6f2ff-->
        <div class="row row-eq-height" align="center">
	    <div class="col-md-2" >
	      <div align="left">
		<div class="col-md-1"><a href="https://github.com/DSOlab/StrainTool/blob/master/LICENSE"><img src="http://img.shields.io/badge/license-MIT-brightgreen.svg" alt="License MIT" /></a></div>
		  <div class="col-md-2"><a href="https://travis-ci.org/DSOlab/StrainTool"><img src="https://travis-ci.org/DSOlab/StrainTool.svg?branch=travis_patch" alt="Build Status" /></a></div>
		  <div class="col-md-2"><a href="https://github.com/DSOlab/StrainTool/releases/latest"><img src="https://img.shields.io/github/release/DSOlab/StrainTool.svg" alt="" /></a></div>
		  <div class="col-md-2"><a href="https://github.com/DSOlab/StrainTool/tags"><img src="https://img.shields.io/github/tag/DSOlab/StrainTool.svg" alt="" /></a></div>
		  <div class="col-md-2"><a href="https://github.com/DSOlab/StrainTool/stargazers"><img src="https://img.shields.io/github/stars/DSOlab/StrainTool.svg" alt="" /></a></div>
		  <div class="col-md-2"><a href="https://github.com/DSOlab/StrainTool/network"><img src="https://img.shields.io/github/forks/DSOlab/StrainTool.svg" alt="" /></a></div>
		  <div class="col-md-2"><a href="https://github.com/DSOlab/StrainTool/issues"><img src="https://img.shields.io/github/issues/DSOlab/StrainTool.svg" alt="" /></a></div>
		  <div class="col-md-2"><a href="https://doi.org/10.5281/zenodo.1297565"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.1297565.svg" alt="DOI"></a></div>
		</div>
	    </div>
            <div class="col-md-8" >
                <p class="page-header-p">StrainTool</p>
                <p> A software package to estimate strain tensor parameters</p>
                <!--<small class="text-muted">Github Link</small>
                <a class="btn btn-lg btn-social-icon btn-git" href="https://github.com/DSOlab/StrainTool" title="StrainTool on github">
                <span class="fa fa-github"></span></a>-->
                <div align="center">
		    <button type="button" class="btn btn-danger"><a class="buttons" href="https://github.com/DSOlab/StrainTool/zipball/master">Download ZIP</a></button>
		    <button type="button" class="btn btn-danger"><a class="buttons" href="https://github.com/DSOlab/StrainTool/tarball/master">Download TAR</a></button>
		    <button type="button" class="btn btn-success"><a class="buttons github" href="https://github.com/DSOlab/StrainTool">View on GitHub</a></button>
                </div>
            </div>
	    <div class="col-md-2">
	    <div class="row row-eq-height">
	        <div class="col-md-6">
		    <a href="https://www.epos-ip.org" target="blank"><img src="https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/EPOS_logo_small_591_0.png" class="img-fluid" style="max-width: 100%; height: auto; align: center;"></a>
		</div>
		<div class="col-md-6">
		    <a href="https://www.epos-ip.org/tcs/gnss-data-and-products" target="_blank"><img src="https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/EPOS_IP_TCS_10_b_transp.png" class="img-fluid" style="max-width: 60%; height: auto; align: center;"></a>
		</div>
	      </div>
                
	      <div class="row row-eq-height">
		<div class="col-md-6">
		    <a href="http://www.noa.gr/index.php?lang=en" target="_blank"><img src="https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/eaa.jpg" class="img-fluid" style="max-width: 100%; height: auto; align: center;"></a>
		</div>
		<div class="col-md-6">
		    <a href="http://portal.survey.ntua.gr/main/labs/hgeod/DSO/DSOmain-en.htm" target="_blank"><img src="https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/DSOtrans.png" class="img-fluid" style="max-width: 100%; height: auto; align: center;"></a>
		</div>
	      </div>
            </div>
        </div>
        <hr>
</div>

    <div class="container-fluid">
        <div class="row">
        <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2">
                <nav id="toc" data-toggle="toc" class="navbar sticky-top"></nav>
            </div>

        <!-- main content area -->
        <div class="col-sm-8">
       
    
<!--        <h1>StrainTool</h1>
        <p>A software package to estimate strain tensor parameters</p>-->

        <h1>General</h1>
        <p>StrainTool allows the estimation of Strain Tensor parameters, on the
        earth's crust, given a list of data point, aka points on the earth along
        with their tectonic velocities.</p> 
        <p>StrainTool has three basic components:
            <ul>
            <li>A python package, named <code>pystrain</code></li>
            <li>The main executable, named <code>StrainTensor.py</code></li>
            <li>A list of shell scripts to plot results from <code>StrainTensor.py</code></li>
            </ul>
        </p>
        <h2 id="pystrain_pkg">pystrain Package</h2>
        <p><code>pystrain</code> is a package written in <a href="https://www.python.org/">python</a>,
        defining a variety of functions, classes, etc to enable the computation of
        strain tensors.</p>
        <p>When installing this package, all of its modules will be available to
        the user. It is the <i>core</i> part of the project and should be installed
        before the main program (<code>StrainTensor.py</code>) can be used.</p>
        <p>The package is found under <code>StrainTool/pystrain</code></p2>
        <h2 id="straintensor_prg">StrainTensor.py</h2>
        <p>This is the <i>main program</i>, i.e the program that the user will
        run to produce strain tensor results. It is heavily dependant on the
        <code>pystrain</code> package (so any change there will affect 
        <code>StrainTensor.py</code>'s behaviour</p>
        <p>This program does not need installation; it is just a pyrhon script.
        The user may only need to change priviledges to make it executable</p>
        <p><code>StrainTensor.py</code> is located at <code>StrainTool/bin</code></p2>
        <h2 id="plot_tools_pck">Plot Tools</h2>
        <p>By 'Plot Tools', we mean an array of shell (<a href="https://www.gnu.org/software/bash/">Bash</a>)
        scripts that can be used to plot <code>StrainTensor.py</code> results.
        These scripts actualy use <a href="http://gmt.soest.hawaii.edu/">GMT</a> to
        perform the plotting. The scripts are an efficient, ready-to-use</p>
        <p>It is by no means mandatory to use these scripts to plot the results; users
        can use their own tools and/or scripts to do so. Actualy, this is a totaly
        independent part of the Project and can be skipped alltogether.</p>
        <p>These scripts, are found under <code>StrainTool/plot</code></p2>
        
        <h1>Installation</h1>
        <h2>Prerequisites</h2>
        <p>To install the Project, you will need:
        <ul>
            <li><a href="https://www.python.org/downloads/">python</a>; the installation has been
                tested under Versions 2.7 and 3.6 and both work fine.</li>
            <li><a href="http://www.numpy.org/">NumPy</a>; NumPy is the fundamental
                package for scientific computing with Python.</li>
            <li><a href="https://www.scipy.org/">SciPy</a>; SciPy is a Python-based
                ecosystem of open-source software for mathematics, science, and engineering.
                Actualy, we are only using the <a href="https://docs.scipy.org/doc/scipy/reference/linalg.html">SciPy.linalg</a>
                and <a href="https://docs.scipy.org/doc/scipy/reference/spatial.html">SciPy.spatial</a> modules.</li>
        </ul>
        Both <code>NumPy</code> and <code>SciPy</code> have extended installation guides
        for most, if not all, operating systems.</p>
        <div class="alert alert-warning" role="alert">
        <p>To use the <a href="#plot_tools_pck">Plot Tools</a> bundle, you must have
        <a href="http://gmt.soest.hawaii.edu/">GMT</a> (> 5.0.0) installed, allong with a
        variety of UNIX-based tools. </p>
        <ul>
          <li>If you are on a UNIX/Linux operating system, most or all of them are pre-installed.</li>
          <li>For Windows OS you can install <a href="https://git-scm.com/">git-bash</a> and <a href="https://www.ghostscript.com/index.html">ghostscript</a> for executing bash scripts.</li>
        </ul>
        </div>
        <h2>Installation Procedure</h2>
        <p>To install the Project, you actualy only need to install the
        <a href="pystrain_pkg">pystrain</a> package. What this means, is that
        python will see that the package modules are build and extracted to a suitable folder
        on your local system (something like <code>/usr/lib/python2.7/site-packages/</code> on
        a UNIX-like system). After this step, you will be able to make use of the
        modules in the package, both for running <code>StrainTool.py</code> and
        for any new program you may wish to code. <mark><a href="#straintensor_prg">StrainTensor.py</a>
        and <a href="#plot_tools_pck">Plot Tools</a> are programs, so you do not
        have to "install" them.</mark></p>
        <p>To install <a href="#pystrain_pkg">pystrain</a>, do the following:
        <ol>
            <li>go to the directory the package is located, i.e. <code>StrainTool/pystrain</code></li>
            <li>the package comes with a <code>setup.py</code> script, so you only need
            to run it (as root/administrator): <pre id="inline-code"><code>$> python setup.py install</code></pre></li>
        </ol>
        That's it! The package modules should now be in place and you should be able to
        use the main script, <a href="#straintensor_prg">StrainTensor.py</a></p>
        <div class="alert alert-info" role="alert">
        To quickly verify that the installation succeded, you can try to load the module,
        using the command: <pre id="inline-code"><code>$> python -c "import pystrain"</code></pre>
        No error message should be displayed on screen.</div>
        
        <h2 id="installation-tests">Installation tests</h2>
	<p>The following scenarios have been tested to validatethe installation procedure</p>
	<table  class="table">
	    <thead>
	    <tr class="header">
	    <th style="text-align: center;">OS</th>
	    <th style="text-align: center;">Python 2.7</th>
	    <th style="text-align: center;">Python 3.6</th>
	    <th style="text-align: center;">GMT 5.2</th>
            <th style="text-align: center;">GMT 5.4</th>
	    </tr>
	    </thead>
	    <tbody>
	    <tr class="odd">
	    <td style="text-align: center;">Fedora</td>
	    <td style="text-align: center;">&#10004;</td>
	    <td style="text-align: center;"></td>
	    <td style="text-align: center;">&#10004;</td>
            <td style="text-align: center;"></td>
	    </tr>
	    <tr class="even">
	    <td style="text-align: center;">Manjaro</td>
	    <td style="text-align: center;"></td>
	    <td style="text-align: center;">&#10004;</td>
	    <td style="text-align: center;">&#10004;</td>
            <td style="text-align: center;"></td>
	    </tr>
	    <tr class="odd">
	    <td style="text-align: center;">Ubuntu</td>
	    <td style="text-align: center;">&#10004;</td>
	    <td style="text-align: center;">&#10004;</td>
	    <td style="text-align: center;">&#10004;</td>
            <td style="text-align: center;">&#10004;</td>
	    </tr>
	    <tr class="even">
	    <td style="text-align: center;">Windows 10</td>
	    <td style="text-align: center;">&#10004;</td>
	    <td style="text-align: center;">&#10004;</td>
	    <td style="text-align: center;">&#10004;</td>
            <td style="text-align: center;">&#10004;</td>
	    </tr>
	    </tbody>
	</table>
        
        <h2 id="straintensor_prg_example">Example</h2>
        <p>To validate that the installation has succeded, you can run a "test case"
        scenario. Under the folder <code>data/</code>, you will find a file named
        <code>CNRS_midas.vel</code>. This ascii file, contains velocity and coordinate information
        for a large list of GPS/GNSS stations around the globe. We will use it to
        perform a test run of <code>StrainTensor.py</code>.</p>
        <p>Go to the <code>bin/</code> folder and execute the command:
        <pre id="block-code"><code>$> ./StrainTensor.py -i ../data/CNRS_midas.vel -r 18.75/30.25/32.75/42.25 --x-grid-step=0.5 --y-grid-step=0.5 --dmin=1 --dmax=500 --dstep=1 --Wt=24 -c</code></pre>
        <em>(You may not need the ./ part at the begining if you are on a Wnidows system)</em>. This command will
        compute Strain Tensor parameters for approximately the whole of Greece, using the input file <code>CNRS_midas.vel</code>.
        The results will be written in a (newly created) file, named <code>strain_info.dat</code>,
        while station information will be written in the file <code>station_info.dat</code>
        (this latter file is mainly used for plotting). You should be able to verify that
        both files have been succesefuly created. </p>
        <p>Under <code>data/</code> you will find the "reference" output files for checking,
        named <code>strain_info.dat.ref</code> and <code>station_info.dat.ref</code>.
        Verify that the files you have just created (placed under <code>bin/</code>)
        contain the same results as the "reference" files (this can be very easily
        performed using the <a href="https://www.gnu.org/software/diffutils/">diff</a> command).</p>
        <h3>Plot example files and compare</h3>
	  <table  class="table">
	    <thead>
	    <tr class="header">
	    <th style="text-align: center;">Principal axis</th>
	    <th style="text-align: center;">Shear strain</th>
	    <th style="text-align: center;">Delaunay triangles</th>
	    </tr>
	    </thead>
	    <tbody>
    	    <tr class="odd">
	    <td style="text-align: left;"><code>$> ./gmtstrainplot.sh -jpg -str strain_info.dat -psta -l -o output_str</code> </td>
	    <td style="text-align: left;"><code>$> ./gmtstrainplot.sh -jpg -gtot strain_info.dat -psta -l -o output_gtot</code> </td>
	    <td style="text-align: left;"><code>$> ./gmtstrainplot.sh -jpg -str strain_info.dat -psta -l -o output_str -deltr</code> </td>
	    </tr>
	    <tr class="even">
	    <td style="text-align: center;"><img src="https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/output_str.jpg" class="img-fluid" style="max-width: 100%; height: auto; align: center;"></td>
	    <td style="text-align: center;"><img src="https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/output_gtot.jpg" class="img-fluid" style="max-width: 100%; height: auto; align: center;"></td>
	    <td style="text-align: center;"><img src="https://raw.githubusercontent.com/DSOlab/StrainTool/gh-pages/img/output_str_veis.jpg" class="img-fluid" style="max-width: 100%; height: auto; align: center;"></td>
	    </tr>
	    </tbody>
	  </table>
        
        <h1>How to use StrainTensor.py</h1>
        <p><code>StrainTensor.py</code> computes strain tensor parameters on a selected region. The
        program comes with an extended help message, that can be displayed via the
        <kbd>-h</kbd> or <kbd>--help</kbd> switch (aka <pre id="inline-code"><code>$> ./StrainTensor.py [...] --help</code></pre>
        will show the help message on screen). Users can controll <code>StrainTensor.py</code>'s
        behaviour via a variety of available switches.</p>
        <h2>Basic Usage</h2>
        <p>To use the program, the only mandatory switch is the <kbd>-i</kbd> or <kbd>--input-file</kbd>,
        which specifies the input file to be used. All other options will automaticaly
        assume default values (see <a href="#straintool_prg_opt">Options</a> for a detailed list).
        Basic usage is described below: <pre id="block-samp"><samp>usage: StrainTensor.py [-h] -i INPUT_FILE [--x-grid-step X_GRID_STEP]
                       [--y-grid-step Y_GRID_STEP] [-m METHOD] [-r REGION]
                       [-c] [-b] [--max-beta-angle MAX_BETA_ANGLE]
                       [-t WEIGHTING_FUNCTION] [--Wt Wt] [--dmin D_MIN]
                       [--dmax D_MAX] [--dstep D_STEP] [--d-param D_PARAMETER]
                       [-g] [--verbose] [-v]<samp></pre>
        <h2 id="straintool_prg_opt">Options</h2>
        <p>The whole list of available options, is:
        <pre id="block-samp"><samp>optional arguments:
          -h, --help            show this help message and exit
  -i INPUT_FILE, --input-file INPUT_FILE
                        The input file. This must be an ascii file containing the columns: 'station-name longtitude latitude Ve Vn SigmaVe SigmaVn Sne time-span'. Longtitude and latitude must be given in decimal degrees; velocities (in east and north components) in mm/yr. Columns should be seperated by whitespaces. Note that at his point the last two columns (aka Sne and time-span) are not used, so they could have random values.
  --x-grid-step X_GRID_STEP
                        The x-axis grid step size in degrees. This option is only relevant if the program computes more than one strain tensors. Default is 0.5(deg).
  --y-grid-step Y_GRID_STEP
                        The y-axis grid step size in degrees. This option is only relevant if the program computes more than one strain tensors. Default is 0.5(deg)
  -m METHOD, --method METHOD
                        Choose a method for strain estimation. If 'shen' is passed in, the estimation will follow the algorithm described in Shen et al, 2015, using a weighted least squares approach. If 'veis' is passed in, then the region is going to be split into delaneuy triangles and a strain estimated in each barycenter. Default is 'shen'.
  -r REGION, --region REGION
                        Specify a region; any station (in the input file) falling outside will be ommited. The region should be given as a rectangle, specifying min/max values in longtitude and latitude (using decimal degrees). E.g. "[...] --region=21.0/23.5/36.0/38.5 [...]"
  -c, --cut-excess-stations
                        This option is only considered if the '-r' option is set. If this this option is enabled, then any station (from the input file) outside the region limit (passed in via the '-r' option) is not considered in the strain estimation.
  -b, --barycenter      Only estimate one strain tensor, at the region's barycentre.
  --max-beta-angle MAX_BETA_ANGLE
                        Only relevant for '--mehod=shen'. Before estimating a tensor, the angles between consecutive points are computed. If the max angle is larger than max_beta_angle (in degrees), then the point is ommited (aka no tensor is computed). This option is used to exclude points from the computation tha only have limited geometric coverage (e.g. the edges of the grid). Default is 180 deg.
  -t WEIGHTING_FUNCTION, --weighting-function WEIGHTING_FUNCTION
                        Only relevant for '--mehod=shen'. Choose between a 'gaussian' or a 'quadratic' spatial weighting function. Default is 'gaussian'.
  --Wt Wt               Only relevant for '--mehod=shen' and if 'd-param' is not passed in. Let W=Σ_i*G_i, the total reweighting coefficients of the data, and let Wt be the threshold of W. For a given Wt, the smoothing constant D is determined by Wd=Wt . It should be noted that W is a function of the interpolation coordinate, therefore for the same Wt assigned, D varies spatially based on the in situ data strength; that is, the denser the local data array is, the smaller is D, and vice versa. Default is Wt=24.
  --dmin D_MIN          Only relevant for '--mehod=shen' and if 'd-param' is not passed in. This is the lower limit for searching for an optimal d-param value. Unit is km. Default is dmin=1km.
  --dmax D_MAX          Only relevant for '--mehod=shen' and if 'd-param' is not passed in. This is the upper limit for searching for an optimal d-param value. Unit is km. Default is dmax=500km.
  --dstep D_STEP        Only relevant for '--mehod=shen' and if 'd-param' is not passed in. This is the step size for searching for an optimal d-param value. Unit is km. Default is dstep=2km.
  --d-param D_PARAMETER
                        Only relevant for '--mehod=shen'. This is the 'D' parameter for computing the spatial weights. If this option is used, then the parameters: dmin, dmax, dstep and Wt are not used.
  -g, --generate-statistics
                        Only relevant when '--mehod=shen' and '--barycenter' is not set. This option will create an output file, named 'strain_stats.dat', where estimation info and statistics will be written.
  --verbose             Run in verbose mode (show debugging messages)
  -v                    Display version and exit.</samp></pre></p>
        <p>For example, the command we used on the <a href="#straintensor_prg_example">Example</a> section:
        <pre id="block-code"><code>$> ./StrainTensor.py -i ../data/CNRS_midas.vel -r 18.75/30.25/32.75/42.25 --x-grid-step=0.5 --y-grid-step=0.5 --dmin=1 --dmax=500 --dstep=1 --Wt=24 -c</code></pre>
        meant that we are estimating strain tensor parameters for the region within min/max
        longtitude: \(18.75/30.25 degrees\) and min/max latitude: \(32.75/42.25 degrees\).
        We are seperating the region into cells of size 0.5 degrees and estimating one
        strain tensor in each cell centre; aka the first cell centre is \(lon = lon_{min} + lon_{step}/2 = 18.75 + 0.5/2=19.0deg\) and
        \(lat = lat_{min} + lat_{step}/2 = 32.75 + 0.5/2 = 33.0deg.\), then next one
        will be at \(lon=19.5, lat=33.5\), etc). To estimate each strain tensor, the program will
        search for a "optimal" D coefficient within the range \([1, 500) km\) with a step of \(1km\).
        This "optimal" D will be found when the condition \(W = \sum_{n=1}^{\#sta*2} Z(i)*L(i) \geq W_t\)
        is met. The stations that will be used for the calculations are only those 
        that fall within the specified longtitude/latitude range. For more information, see
        <a href="#bck_and_algorithms">Background and Algorithms</a> section.</p>
        <h2 id="input_files">Input Files</h2>
        <p>To perform the computations, <code>StrainTensor.py</code> needs an input file, 
        that holds input data. Usually, this implies a list of GPS/GNSS stations with 
        their ellipsoidal coordinates (aka longtitude and latitude) and their respective 
        tectonic velocities (usually estimated using position time-series) allong with
        the corresponding standard deviation values. The format of these files,
        should follow the convention: 
        <pre id="block-samp"<samp>
        station-name  longtitude   latitude   Ve     Vn    SigmaVe  SigmaVn  Sne  time-span 
         string           deg.        deg.   mm/yr  mm/yr   mm/yr    mm/yr    /   dec. years</samp></pre>
        Station coordinates are provided in longtitude/latitude pairs in decimal degrees.
        Velocities and velocity standard deviations are provided in mm per years (mm/yr).
        <code>Sne</code> is the correlation coefficient between East and North velocity components
        and <code>time-span</code> is the total time span of the station timeseries in decimal
        degrees. <div class="alert alert-warning" role="alert">Note that at his point the last two columns (aka <code>Sne</code>
        and <code>time-span</code>) are not used, so they could have random values.</div></p>
        <p>There are no strict formating rules on how the individual elements should be
        printed (i.e. how many fields, decimal places, etc). <mark>The only condition is 
        that fields are seperated by whitespace(s)</mark>. To see an example of a valid
        input file, you can check <code>data/CNRS_midas.vel</code>.</p>
        <h2 id="output_files">Output Files</h2>
	<p>Results of <code>StrainTensor.py</code> are recorded in the following three files: </p>
	  <ul>
	    <li><b>strain_info.dat</b> This file includes strain tensor parameters, principal axis, rotational rates, dilatation etc.<br>The columns of the file are structured as below:</li>
		 <pre id="block-samp"><samp>
Latitude Longtitude vx+dvx  vy+dvy   w+dw     exx+dexx    exy+dexy    eyy+deyy   emax+demax  emin+demin   shr+dshr  azi+dazi  dilat+ddilat   sec. invariant 
   deg       deg     mm/yr   mm/yr  marcsec/yr  nstrain/yr  nstrain/yr  nstrain/yr  nstrain/yr  nstrain/yr  nstrain/yr    deg.    nstrain/yr    nstrain/yr</samp></pre>
	    <li><b>station_info.dat</b> Station's data used for the calculation of strain tensor are written at this file. Format is: </li>
                 <pre id="block-samp"><samp>
Code    Longtitude Latitude  Ve   Vn   dVe  dVn 
string      deg       deg          mm/yr</samp></pre>
	    <li><b>strain_stats.dat</b> This file is only created if the <kbd>--generate-statistics</kbd> switch is on.
            The generated file will hold various information on the system, the command and options used, and statistics of the
            computation. This file can help users get a quick overview of the program's run.</li>
	  </ul>
          <div class="alert alert-warning" role="alert">Note that when using <kbd>--method=shen</kbd>
          to estimate strain tensor parameters, there may be (grid) cells where the estimation is
          not possible under the criteria specified (via the command line options). These nodes
          will not be written in the output files.</div>
        
        <h1>How to use Plot Tools</h1>
        <p>Plotting scripts are placed under <code>plot/</code> directory. They are:
        <ul>
        <li><code>gmtstrainplot.sh</code>,</li>
        <li><code>gmtstatsplot.sh</code>,   and</li>
        <li><code>plotall.sh</code></li>
        </ul>
        All of the scripts need the file named <code>default-param</code> to be in the
        same folder.
        </p>
        <b>default-param file options</b>
        <pre id="block-samp"<samp>
        pth2inptf=../data/  # set default folder for input files (strain_info.dat, station_info.dat)
	west, east, south, north, projscale, frame, sclength: set region parameters
        STRSC=0.01 : set principal axis plot scale
        ROTSC=.7 : set rotational rates plot scale
        </samp></pre>

        <b>gmtstrainplot.sh options:</b>
        <pre id="block-samp"<samp>
Basic Plots & Background :
     -r | --region : region to plot (default Greece)
         usage: -r west east south north projscale frame

PLot station and velocitiess:
    -psta [:=stations] plot only stations from input file
    -vhor (station_file)[:= horizontal velocities]
    -vsc [:=velocity scale] change valocity scale default 0.05

Plot strain tensor parameters:
     -str (strain file)[:= strains] Plot strain rates 
     -rot (strain file)[:= rots] Plot rotational rates 
     -gtot(strain file)[:=shear strain] plot total shear strain rate contours
     -gtotaxes (strain file) dextral and sinistral max shear strain rates
     -dil (strainfile)[:= dilatation] Plot dilatation and principal axes
     -secinv (strain file) [:=2nd invariand] Plot second invariand
     -strsc [:=strain scale]
     -rotsc [:=rotational scales]
  *for -gtot | -dil | -secinv use +grd to plot gridded data
        ex:-gtot+grd 


Other options:
     -o | --output : name of output files
     -l | --labels : plot labels
     -mt | --map_title "title" : title map default none, use quotes
     -jpg : convert eps file to jpg
     -h | --help : help menu
        </samp></pre>
        <p>For example, to plot the principal axis fo strain rates for the example case above you can use the following command:
        <pre id="block-samp"<samp>
$>./gmtstrainplot.sh -jpg -str strain_info.dat -psta -l
        </samp></pre>

        <b>gmtstatsplot.sh options:</b>
        <pre id="block-samp"<samp>
Basic Plots & Background :
     -r | --region : region to plot (default Greece)
         usage: -r west east south north projscale frame

Plot Stations and triangles:
     -psta [:=stations] plot only stations from input file
     -deltr [:= delaunay triangles] plot delaunay triangles

Plot Statistics:
     -stats (input file) set input file
     --stats-stations : plot used stations
     --stats-doptimal : plot optimal distance (D)
     --stats-sigma : plot sigma 

Other options:
     -o | --output : name of output files
     -l | --labels : plot labels
     -leg : plot legends
     -mt | --map_title  : title map default none use quotes
     -jpg : convert eps file to jpg
     -h | --help : help menu
        </samp></pre>
        <p>For example, to plot the stations used per cell grid for the example case above you can use the following command:
        <pre id="block-samp"<samp>
$> ./gmtstatsplot.sh -jpg -stats strain_stats.dat --stats-stations -leg -o output_stats-stations
        </samp></pre>


        <b>plotall.sh options:</b>
        <pre id="block-samp"<samp>
   - no switch produce default output names
   -p | --prefix : add prefix work id to output file
   -s | --suffix : add suffix work id to output file
   -h | --help: help panel
        </samp></pre>
<p>For example:</p>
        <pre id="block-samp"<samp>
$> ./plotall.sh -p test -s test2
        </samp></pre>





        <h1 id="bck_and_algorithms">Background and Algorithms</h1>
        <p>Given a set of stations (aka point on earth's surface) with their
        corresponding east and north velocities, we can estimate (or compute)
        strain tensor parameters, by solving for the system
        $$
        \begin{bmatrix}
            V_{x,S_1} \\ 
            V_{y,S_1} \\ 
            V_{x,S_2} \\ 
            V_{y,S_2} \\ 
            \cdots \\ 
            V_{x,S_n} \\ 
            V_{y,S_n} \\ 
        \end{bmatrix}
        =
        \begin{bmatrix}
            1 & 0 & \Delta_{y_1}  & \Delta_{x_1} & \Delta_{y_1} & 0 \\
            0 & 1 & -\Delta_{x_1} &  0           & \Delta_{x_1} & \Delta_{y_1} \\
            1 & 0 & \Delta_{y_2}  & \Delta_{x_2} & \Delta_{y_2} & 0 \\
            0 & 1 & -\Delta_{x_2} &  0           & \Delta_{x_2} & \Delta_{y_2} \\
            \cdots & \cdots & \cdots & \cdots & \cdots & \cdots \\
            1 & 0 & \Delta_{y_n}  & \Delta_{x_n} & \Delta_{y_n} & 0 \\
            0 & 1 & -\Delta_{x_n} &  0           & \Delta_{x_n} & \Delta_{y_n} \\
        \end{bmatrix}
        \begin{bmatrix}
            U_{x} \\ 
            U_{y} \\ 
            \omega \\ 
            \tau_{x} \\ 
            \tau_{xy} \\ 
            \tau_{y} \\ 
        \end{bmatrix}
        $$
        at any given location \(R\); \(\Delta_{x_i}\) and \(\Delta_{y_i}\) are the displacement
        components between station \(i\) and the point \(R\). A minimum of 3 stations
        is required to compute the parameters; if more than 3 stations are used, then
        the parameters are estimated (here, using a least squares approach).</p>
        <h2>Covariance Matrix</h2>
        <p>Assuming that we have variance information for the station velocities (and a Gaussian distribution),
        we can add the covariance matrix \(C\) of the velocity data in the system.
        In the simplest case, \(C\) is a diagonal matrix, with the velocity component
        standard deviations as its elements,
        $$
        C = {\sigma_{0}}^2 
        \begin{bmatrix}
            (1/\sigma_{V_{x,S_{1}}})^2  & 0                      & 0                      & \cdots & 0 \\
            0                       & (1/\sigma_{V_{y,S_{1}}})^2 & 0                      & \cdots & 0 \\
            0                       & 0                      & (1/\sigma_{V_{x,S_{2}}})^2 & \cdots & 0 \\
            \vdots                  & \vdots                 & \vdots                 & \ddots & \vdots \\
            0                       & 0                      & 0                      & \cdots & (1/\sigma_{V_{y,S_{n}}})^2 \\
        \end{bmatrix}
        $$</p>
        <p><a href="#shen_et_al_2015">Shen et al, 2015</a>, propose a more elaborate approach, reconstructing the 
        covariance matrix by multiplying a weighting function to each of its diagonal terms.
        The weighting function \(G_i = L_i \cdot Z_i\), in which \(L_i\) and \(Z_i\) 
        are functions of distance and spatial coverage dependent, respectively. 
        The final covariance matrix becomes then, \(C = C \cdot G^{-1}\) or, since its diagonal,
        \(C_i = C_i \cdot {G_i}^{-1}\)</p>
        <div class="alert alert-info">
            <strong>Info</strong> Note that covariance matrices are only used with <kbd>--method=shen</kbd>.
        </div>
        <div class="alert alert-warning" role="alert">
            Velocity covariance values, aka \(\sigma_{V_{x} V_{y}}\) are not considered while forming the covariance matrix \(C\), 
            even though the corresponding values are provided and read from the <a href="#input_files">input</a> file.
        </div>
        <h2>Shen et al, 2015</h2>
        <p>The following paragraphs, describe the estimation process when using <em>shen</em> method
        (i.e. <kbd>--method=shen</kbd>) as the algorithm of choice.</p>
        <p>In coarse lines, when choosing the <em>shen</em> method, the program will
        'girddify' the region of choise and estimate one strain tensor at the centre of each cell.
        The region of choise can be given via the <kbd>--region</kbd> switch, using
        minimum and maximum longtitude and latitude as decimal degrees, using '/' as
        delimeter. E.g. <code>[...] --region=21.0/23.5/36.0/38.5 [...]</code>. If the region
        is not specified, then the maximum and minimum longtitude values will be extracted from the
        list of input stations, aka the region will be defined to include all stations
        within the input file.</p>
        <p>The user can specify the grid step size, both in x and y components, via the
        <kbd>--x-grid-step</kbd> and <kbd>--y-grid-step</kbd> switches respectively.
        The step sizes should be given in decimal degrees and if not set, have a
        default value of \(0.5 deg.\)</p>
        <p>The program will try to estimate strain tensor parameters at the centre of
        each cell. The algorithm depends on a number of options that the user can
        define via the command line arguments. Using a spatial smoothing coefficient
        \(D\), either defined by the user (<kbd>--d-param</kbd>) or found by the
        program (see <a href="#finding_optimal_d">Finding the optimal smoothing parameter \(D\)</a>),
        the covariance matrix will be formed, using <a href="#distance_weights">distance-dependent weighting</a> \(L_i\),
        <a href="#spatial_weights">spatial weighting</a> \(Z_i\) and the data variance information \(C_i\).
        The final covariance matrix, will be \(C \cdot G^{-1}\) where \(G_i = L_i \cdot Z_i\).</p>
        <p>Strain tensor parameters will be estimated using a (weighted) least squares approach;
        Six fundamental parameters are solved for and in a next step values of interest
        are computed (see <a href="#strain_ttensor_parameters">Strain Tensor Parameters</a>).
        Computed values are written to the output file <code>strain_info.dat</code> (see <a href="#output_files">Output Files</a>).</p>
        <div class="alert alert-warning" role="alert">Note that there may be (grid) cells where the estimation is
        not possible under the criteria specified (e.g. and optiaml value for \(D\) could not be found
        within the specified range). These nodes will not be written in the output files.</div>

        <h3 id="distance_weights">Distance-dependent Weighting</h3>
        <p>For distance dependent weighting \(L_i\), we can use two formulas,
        $$L_i = \exp(-{\Delta}R_i^{2} / D^{2})$$ or $$L_i = 1/(1 + {\Delta}R_i^{2} / D^{2})$$
        n which a spatial smoothing parameter \(D\) is introduced (see 
        <a href="#finding_optimal_d">Finding the optimal smoothing parameter</a>). According to 
        <a href="#shen_et_al_2015">Shen et al, 2015</a>, 
        <blockquote class="blockquote text-center">
        <p class="mb-0">Both functions allow reduced weight of the data as distance
        increases. The difference between the two is that the Gaussian
        function reduces the weight at a faster pace with distance \(\Delta R_i\)
        than that of the quadratic function. Depending on the data
        quality, the Gaussian function can offer a relatively finer resolution
        of the interpolation result if the data are clean and smooth. On
        the other hand, if the data are somewhat heterogeneous, the
        quadratic function is relatively more conservative and provides
        a more smoothed solution, especially for regions in which data
        are sparsely distributed.</p>
        </blockquote></p>
        <div class="container"> 
            <div id="chart_div">
                <canvas id="myChart"></canvas>
            </div>
            <div id="dparam_div">
                Parameter D:
                <input type="number" id="dparam" value="15">
                <button onclick="submit_data();">Try it</button>
            </div>
        </div>
        <h3 id="finding_optimal_d">Finding the optimal smoothing parameter \(D\)</h3>
        <p>To actually compute the distance-dependent weights \(L_i\), we need the
        smoothing coefficient \(D\). Users have two options,
        <ul>
            <li>either pass in the parameter value as a command line option via <kbd>--d-param</kbd>, or</li>
            <li>search for an optimal \(D\) value, given the range \(D_{min}\), \(D_{max}\), \(D_{step}\) and the limit value \(W_t\) (via <kbd>--dmin</kbd>, <kbd>--dmax</kbd>, <kbd>--dstep</kbd> and <kbd>--Wt</kbd>)</li>
        </ul>
        When searching for an optimal \(D\) value, we use the approach introduced by
        Shen et al, 2007; for every \(D\) value within the range \([D_{min}, D_{max})\) with a step of \(D_{step}\),
        <ol>
            <li>we filter the station list, based on the cut-off distance, see <a href="#filtering_stations">Filtering Stations</a>,</li>
            <li>compute distance-dependent and spatial weights, \(L_i\) and \(Z_i\) respectively, for every station</li>
            <li>compute the sum \(W = 2 \cdot \sum_{n=1}^{\#sta} Z_i * L_i \)</li>
            <li>repeat the process for the next \(D\) value if \( int(W) < int(W_t) \), else current \(D\) value is optimal</li>
        </ol>
        If we reach the end of the range and no optimal value for \(D\) is found, then no tensor
        parameters are estimated for the current point.</p>
        <h3 id="filtering_stations">Filtering Stations</h3>
        <p>Any data points with distance exceeding a threshold value \(L_{max}\)
        are excluded from the estimation. The value of \(L_{max}\) depends on the
        Distance-dependent weighting function; if a Gaussian approach is selected, then
        \(L_{max}=2.15 \cdot D km \), while for the quadratic approach \(L_{max}=10 \cdot D km \)
        , where \(D\) is the spatial smoothing parameter.</p>
        <h3 id="spatial_weights">Spatial Weights</h3>
        <p>The spatial weighting function measures the azimuth span of the site 
        with respect to each of the data points. The azimuth span \(\theta\) for 
        data point \(i\) is measured between two strike directions of the \(i−1\)
        and \(i+1\) data points in its neighborhood.</p>
        <div class="container"> 
            <div id="chart_div2">
                <canvas id="myChart2"></canvas>
            </div>
        </div>
        <h2>Veis</h2>
        <p>When using <kbd>--method=veis</kbd> a different aproach is followed. The region is
        split into <a href="https://en.wikipedia.org/wiki/Delaunay_triangulation">Delaunay triangles</a>
        at the barycentre of which a strain tensor is computed. Note that this approach
        only uses three points (aka the triangle points) to calculate tensor parameters, so
        <mark>the parameters are computed and not estimated</mark>. Covariance info is
        not used at all with this approach.</p>
        <p>Note that when using this approach,
        <ul>
        <li>No sigma values will be available in the <code>strain_info.dat</code> file (remember this a computation not an estimation),</li>
        <li>Delauney triangulation info will be written in a file named <code>delaunay_info.dat</code>,</li>
        <li>if the user requested a statistics file (aka <kbd>--generate-statistics</kbd>), then this file will have
        no statistics info; it will only report system and command info</li>
        </ul></p>
        <h2>Estimating One Strain Tensor</h2>
        <p>TODO</p>
        <h2 id="strain_tensor_parameters">Strain Tensor Parameters</h2>
        <p>The computation/estimation process, solves for the vector of parameters
        \([U_{x}, U_{y}, \omega, \tau_{x}, \tau_{xy}, \tau_{y}]^T\). The rest
        parameters of interest, written in the output file <a href="#output_files"></a>,
        are computed as follows:
         $$ \tau_{max}= \sqrt{ {\tau_{xy}}^2 + {e_{diff}}^2 } $$
         $$ e_{max}  = e_{mean} + \tau_{max} $$
         $$ e_{min}  = e_{mean} - \tau_{max} $$
         $$ Az_{e_{max}}  = 90 + \frac{-atan2(\tau_{xy}, e_{diff})}{2} $$
         $$ dilatation = \tau_{x} + \tau_{y} $$
         $$ second invariant = \sqrt{ {\tau_{x}}^2 + {\tau_{y}}^2 + 2{\tau_{xy}}^2  }$$
         where,
         $$ e_{mean} = \frac{\tau_{x}+\tau_{y}}{2} $$
         $$ e_{diff} = \frac{\tau_{x}-\tau_{y}}{2} $$
        </p>
        
        <h1 id="contributing">Significant Bugs Fixed</h1>
        <ul>
          <li><b>v1.0-rc2.0</b> The calculation of second invariant was corrected due to a mistake in the previou version (v1.0-rc1.0)</li>
        </ul>

        <h1 id="contributing">Contributing</h1>
        <ol>
          <li>Create an issue and describe your idea</li>
          <li><a href="https://github.com/DSOlab/StrainTool/network#fork-destination-box">Fork it</a></li>
          <li>Create your feature branch (<code>git checkout -b my-new-idea</code>)</li>
          <li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
          <li>Publish the branch (<code>git push origin my-new-idea</code>)</li>
          <li>Create a new Pull Request</li>
          <li>Profit! &#10004;</li>
        </ol>

        <h1 id="license">License</h1>
        <p>The work is licensed under <a href="https://github.com/DSOlab/StrainTool/blob/dev-danast/.github/CHANGELOG.md">MIT-license</a></p>
      
        <h1 id="authorsbugreports">Authors &amp; Bug Reports</h1>
        <p><strong>Dr. Dimitrios G. Anastasiou</strong></p>
        <blockquote>
          <p>Dr.Eng Rural &amp; Surveying Engineer | Dionysos Satellite Observatory - NTUA | <a href="mailto:dganastasiou@gmail.com">dganastasiou@gmail.com</p></a>
        </blockquote>
        <p><strong>Xanthos Papanikolaou</strong></p>
        <blockquote>
          <p>Rural &amp; Surveying Engineer | Dionysos Satellite Observatory - NTUA | <a href="mailto:xanthos@mail.ntua.gr">xanthos@mail.ntua.gr</a></p>
        </blockquote>
        <p><strong>Dr. Athanassios Ganas</strong></p>
        <blockquote>
          <p>Research Director | Institute of Geodynamics | National Observatory of Athens | <a href="mailto:aganas@gein.noa.gr">aganas@gein.noa.gr</a></p>
        </blockquote>
        <p><strong>Prof. Demitris Paradissis</strong></p>
        <blockquote>
          <p>Professor NTUA | Dionysos Satellite Observatory - NTUA  | <a href="mailto:dempar@central.ntua.gr">dempar@central.ntua.gr</a></p>
        </blockquote>

        <h1 id="changelog">ChangeLog</h1>
        <p>The history of releases can be viewed at <a href="https://github.com/DSOlab/StrainTool/blob/master/.github/CHANGELOG.md">ChangeLog</a></p>
      
        <h1 id="acknowlegments">Acknowlegments</h1>
        <p><strong>EPOS IP - EPOS Implementation Phase</strong></p>
        <p>This project has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement N° 676564</p>
        <p>Disclaimer: the content of this website reflects only the author’s view and the Commission is not responsible for any use that may be made of the information it contains.</p>

        <h1 id="references">References</h1>
        <ul>
          <li id="shen_et_al_2015"><p>Shen, Z.-K., M. Wang, Y. Zeng, and F. Wang, (2015), Strain determination using spatially discrete geodetic data, Bull. Seismol. Soc. Am., 105(4), 2117-2127, doi: 10.1785/0120140247</p></li>
          <li id="veis_et_al_1992"><p>Veis, G., Billiris, H., Nakos, B., and Paradissis, D. (1992), Tectonic strain in greece from geodetic measurements, C.R.Acad.Sci.Athens, 67:129--166</p></li>
          <li id="ref_python"><p>Python Software Foundation. Python Language Reference, version 2.7. Available at http://www.python.org</p></li>
          <li id="ref_gmt"><p><a href="http://gmt.soest.hawaii.edu/">The Generic Mapping Tools - GMT</a></p></li>
        </ul>
    
        <!-- main content area -->
        </div>

    <!-- main container -->
    </div>

    <!-- Javascript code for ploting; load after DOM -->
    <script type="text/javascript" src="straindoc.js"></script>

</body>
